require=function c(s,o,r){function l(t,e){if(!o[t]){if(!s[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(g)return g(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[t]={exports:{}};s[t][0].call(i.exports,function(e){return l(s[t][1][e]||e)},i,i.exports,c,s,o,r)}return o[t].exports}for(var g="function"==typeof require&&require,e=0;e<r.length;e++)l(r[e]);return l}({Const:[function(e,t,a){"use strict";cc._RF.push(t,"6e792exaDdPa6fQyqW8FwCd","Const"),window.G_Con={bigNum:1e18,packageState:{enable:1,eaten:2,outDate:3},packageUrl:"n1pwGsYa2sUERjmQFZjv4ciMPpuSZNFXj8r"},cc._RF.pop()},{}],GlobalData:[function(e,t,a){"use strict";cc._RF.push(t,"e5b91c+z91NhK0FJSE8hcop","GlobalData"),window.G_Data={userDataObj:null,packageDataObj:null,lastUpdateDate:null},cc._RF.pop()},{}],GlobalFuc:[function(e,t,a){"use strict";cc._RF.push(t,"8dd5aFPzulEpoQQmWWREyJt","GlobalFuc"),window.G_Func={formatSeconds:function(e){var t=parseInt(e),a=0,n=0;60<t&&(a=parseInt(t/60),t=parseInt(t%60),60<a&&(n=parseInt(a/60),a=parseInt(a%60)));var i=parseInt(t)+"秒";return 0<a&&(i=parseInt(a)+"分"+i),0<n&&(i=parseInt(n)+"小时"+i),i},isPackageIsMine:function(e){if(G_Data.userDataObj&&G_Data.userDataObj.lsAirdropParcel)for(var t in G_Data.userDataObj.lsAirdropParcel){if(G_Data.userDataObj.lsAirdropParcel[t]==e)return!0}return!1},popTip:function(e){cc.log("popTip : "+e),cc.find("Canvas/tipBg/tipLabel").getComponent(cc.RichText).string=e;var t=cc.find("Canvas/tipBg");t.stopAllActions(),t.setLocalZOrder(99999),t.active=!0,t.opacity=255,t.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.FadeOut(2),new cc.CallFunc(function(){this.active=!1}.bind(t))))},checkCallBack:function(e){null!==e&&"string"==typeof e&&-1<e.indexOf("rejected by user")&&this.popTip("用户取消了交易")},checkExtension:function(){"undefined"==typeof webExtensionWallet&&this.popTip("钱包插件未安装！")}},cc._RF.pop()},{}],MainScene:[function(e,t,a){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","MainScene"),cc.Class({extends:cc.Component,properties:{registLabel:{default:null,type:cc.Label},registNameBox:{default:null,type:cc.EditBox}},onLoad:function(){},regist:function(){cc.log("regist");var e=this.registNameBox.string;G_Net.registerNickname(e)},getInfo:function(){cc.log("regist");this.registNameBox.string;G_Net.getAssemblyInfo()},update:function(e){}}),cc._RF.pop()},{}],NetCenter:[function(e,t,a){"use strict";cc._RF.push(t,"b48c7hLTgdLrIRNhxQ86ZhI","NetCenter"),window.G_Neb={mail:{address:"n1uzUXzMAWLnE2R37LvDw3tNbCqVTrDqnRZ",funcName:"registerNickname"},userInfo:{address:"n1uzUXzMAWLnE2R37LvDw3tNbCqVTrDqnRZ",funcName:"getAssemblyInfo"},getParcelCount:{address:G_Con.packageUrl,funcName:"getParcelCount"},getAssemblyInfo:{address:G_Con.packageUrl,funcName:"getAssemblyInfo"},getParcelData:{address:G_Con.packageUrl,funcName:"getParcelData"},getParcelData_theLatest:{address:G_Con.packageUrl,funcName:"getParcelData_theLatest"},airdropParcel:{address:G_Con.packageUrl,funcName:"airdropParcel"},lickParcel:{address:G_Con.packageUrl,funcName:"lickParcel"},soldOut:{address:G_Con.packageUrl,funcName:"soldOut"}},window.G_Net={callbackAddress:"NebPay.config.mainnetUrl",serialNumberList:[],call:function(e,t,a,n,i){var c=new(neb_require("nebpay")),s={callback:this.callbackAddress,qrcode:{showQRCode:!1,container:void 0},listener:i},o=this._dealArg(n),r=c.call(e,t,a,o,s);this.serialNumberList.push(r),G_Func.popTip("正在交易中")},simulateCall:function(e,t,a,n,i){var c=new(neb_require("nebpay")),s={callback:this.callbackAddress,qrcode:{showQRCode:!1,container:void 0},listener:i},o=this._dealArg(n),r=c.simulateCall(e,t,a,o,s);this.serialNumberList.push(r)},_dealArg:function(e){return JSON.stringify(e)},registerNickname:function(e){this.call(G_Neb.mail.address,0,G_Neb.mail.funcName,[e])},getAssemblyInfo:function(){this.simulateCall(G_Neb.userInfo.address,0,G_Neb.userInfo.funcName,[])},autoCall:function(e,t,a,n){var i="";switch(e){case G_Neb.getParcelCount:case G_Neb.getAssemblyInfo:case G_Neb.getParcelData:case G_Neb.getParcelData_theLatest:i="simulateCall";break;case G_Neb.airdropParcel:case G_Neb.lickParcel:case G_Neb.soldOut:i="call"}this[i](e.address,a,e.funcName,t,n)}},cc._RF.pop()},{}],PackageScene:[function(e,t,a){"use strict";cc._RF.push(t,"87bb1UYcTBOfZsPBOyzYyEV","PackageScene"),cc.Class({extends:cc.Component,properties:{choosePage:{default:0,visible:!1},pageType:{default:null,visible:!1},packagePre:{default:null,type:cc.Prefab},packageBigPre:{default:null,type:cc.Prefab},packagesScollView:{default:null,type:cc.ScrollView},mineSelectImg:{default:null,type:cc.SpriteFrame},historySelectImg:{default:null,type:cc.SpriteFrame},marketSelectImg:{default:null,type:cc.SpriteFrame},mineNormalImg:{default:null,type:cc.SpriteFrame},historyNormalImg:{default:null,type:cc.SpriteFrame},marketNormalImg:{default:null,type:cc.SpriteFrame},senderLayer:{default:null,type:cc.Node},helpLayer:{default:null,type:cc.Node},minVauleEdit:{default:null,type:cc.EditBox},maxValueEdit:{default:null,type:cc.EditBox},costEdit:{default:null,type:cc.EditBox},timeToggle:{default:null,type:cc.ToggleContainer}},ctor:function(){this.pageType={mine:1,history:2,market:3}},onLoad:function(){this.getPackageInfo(),this.choosePage=this.pageType.market,this.reloadPage(),this.schedule(this.getPackageInfo,10),G_Func.checkExtension()},getPackageInfo:function(){this.getMine(),this.getPackage()},start:function(){},onClickSendOutEvent:function(e){if(this.minVauleEdit.string&&this.maxValueEdit.string&&this.costEdit.string&&Number(this.minVauleEdit.string)<=Number(this.maxValueEdit.string)){var t=this.timeToggle.getComponentsInChildren("cc.Toggle"),a=i;for(var n in t){if(t[n].isChecked){a=parseInt(n);break}}var c=Number(this.minVauleEdit.string),s=Number(this.maxValueEdit.string),o=Number(this.costEdit.string),r=new Date,l=parseInt(r.getTime()/1e3);l+=3600*[6,12,24,48,72,288][a],G_Net.autoCall(G_Neb.airdropParcel,[c,s,o,l],s,this.sendCallBack)}else cc.log("short of para")},onClickHistoryEvent:function(e){this.choosePage!=this.pageType.history&&(this.choosePage=this.pageType.history,this.reloadPage())},onClickMineEvent:function(e){this.choosePage!=this.pageType.mine&&(this.choosePage=this.pageType.mine,this.reloadPage())},onClickMarketEvent:function(e){this.choosePage!=this.pageType.market&&(this.choosePage=this.pageType.market,this.reloadPage())},onClickHelpEvent:function(e){this.helpLayer.active=!0},onClickCloseHelpLayer:function(e){this.helpLayer.active=!1},onClickSendEvent:function(e){this.senderLayer.active=!0},onClickCloseSendLayer:function(e){this.senderLayer.active=!1},getMine:function(){G_Net.autoCall(G_Neb.getAssemblyInfo,[],0,this.getMineInfo.bind(this))},getPackage:function(){G_Data.lastUpdateDate=new Date,G_Net.autoCall(G_Neb.getParcelData,[1e5],0,this.getAllPackageInfo.bind(this))},getMineInfo:function(e){cc.log("getMineInfo : "+e),"null"!=e.result&&""!=e.result?G_Data.userDataObj=JSON.parse(e.result):G_Data.userDataObj={},this.reloadPage()},getAllPackageInfo:function(e){if(cc.log("getAllPackageInfo : "+e),e.result){G_Data.packageDataObj={};var t=JSON.parse(e.result);for(var a in t){var n=t[a];G_Data.packageDataObj[n.parid]=n}}this.reloadPage()},reloadBtnType:function(){var e=cc.find("downdi/myPackageBtn",this.node).getComponent(cc.Button),t=cc.find("downdi/historyBtn",this.node).getComponent(cc.Button),a=cc.find("downdi/marketBtn",this.node).getComponent(cc.Button);this.choosePage==this.pageType.mine?(e.normalSprite=this.mineSelectImg,t.normalSprite=this.historyNormalImg,a.normalSprite=this.marketNormalImg):this.choosePage==this.pageType.history?(e.normalSprite=this.mineNormalImg,t.normalSprite=this.historySelectImg,a.normalSprite=this.marketNormalImg):this.choosePage==this.pageType.market&&(e.normalSprite=this.mineNormalImg,t.normalSprite=this.historyNormalImg,a.normalSprite=this.marketSelectImg)},reloadPage:function(){if(this.reloadBtnType(),G_Data.packageDataObj&&G_Data.userDataObj){var e=this.packagesScollView.content;e.removeAllChildren();var t=0,a=this.node.getChildByName("headLabel").getComponent(cc.RichText),n="";if(this.choosePage==this.pageType.mine)for(var i in G_Data.userDataObj.lsAirdropParcel){var c=G_Data.userDataObj.lsAirdropParcel[i],s=G_Data.packageDataObj[c],o=this.getPackageNode(s);cc.log(o),o.parent=e,t++}else if(this.choosePage==this.pageType.history)for(var r in G_Data.userDataObj.lsLickParcel){var l=G_Data.userDataObj.lsLickParcel[r],g=G_Data.packageDataObj[l],p=this.getPackageNode(g);cc.log(p),p.parent=e}else if(this.choosePage==this.pageType.market){var u=[];for(var d in G_Data.packageDataObj){var h=G_Data.packageDataObj[d];u.push(h)}for(var m in u.sort(function(e,t){return parseInt(e.parid)<parseInt(t.parid)}),u){var f=u[m],b=this.getPackageNode(f);cc.log(b),b.parent=e;var k=b.getChildByName("minibaoguo_black");f.parstatus==G_Con.packageState.enable?k.active=!1:k.active=!0}}var C=G_Data.userDataObj.lsLickParcel?G_Data.userDataObj.lsLickParcel.length:0,_=G_Data.userDataObj.totalLickParcel_ticketCost?G_Data.userDataObj.totalLickParcel_ticketCost:0,N=G_Data.userDataObj.totalLickParcel_finalPrices?G_Data.userDataObj.totalLickParcel_finalPrices:0;n=(n=(n="已舔包裹"+C+"个，")+"花费舔包门票<color=#9bc022>"+_/G_Con.bigNum+"</c>NAS，")+"共开出<color=#9bc022>"+N/G_Con.bigNum+"</c>NAS",n=(n=(a.string=n)+"\n待舔包裹"+this.getEnablePackageNum()+"个，")+"最后更新于 : "+G_Data.lastUpdateDate.toLocaleString(),a.string=n,e.height=t/3*330+165}},getEnablePackageNum:function(){var e=0;for(var t in G_Data.packageDataObj){G_Data.packageDataObj[t].parstatus==G_Con.packageState.enable&&e++}return e},getPackageNode:function(e){var t=cc.instantiate(this.packagePre);if(t.getChildByName("pageName").getComponent("cc.Label").string=e.parid+"号包裹",t.getChildByName("packageContentLabel1").getComponent("cc.Label").string=e.ticket_prices/G_Con.bigNum,t.getChildByName("packageContentLabel2").getComponent("cc.Label").string=e.cost_min/G_Con.bigNum+"-"+e.cost_max/G_Con.bigNum,t.package_data=e,t.on(cc.Node.EventType.TOUCH_END,function(e){this.createNewBig(e.currentTarget.package_data)},this),e.parstatus==G_Con.packageState.enable){var a=function(e){var t=this.package_data.recycle_time,a=new Date,n=t-parseInt(a.getTime()/1e3),i=this.getChildByName("packageContentLabel3").getComponent("cc.Label");i.string=n<0?"已过期":24<n/3600?"剩余："+parseInt(n/86400)+"天":"剩余："+G_Func.formatSeconds(n)}.bind(t);t.getComponent(cc.Component).schedule(a,1),a()}else if(e.parstatus==G_Con.packageState.eaten){t.getChildByName("packageContentLabel3").getComponent("cc.Label").string="实际获得："+e.final_prices/G_Con.bigNum}else if(e.parstatus==G_Con.packageState.outDate){t.getChildByName("packageContentLabel3").getComponent("cc.Label").string="已下架"}return t},createNewBig:function(e){var t=cc.instantiate(this.packageBigPre);t.getComponent("PopPackage").setData(e),t.parent=this.node},getMarketInfo:function(e){cc.log(e)},sendCallBack:function(e){G_Func.checkCallBack(e)}}),cc._RF.pop()},{}],PopPackage:[function(e,t,a){"use strict";cc._RF.push(t,"86615iEiwRDHox06RCjx+v7","PopPackage"),cc.Class({extends:cc.Component,properties:{data:{default:null,visible:!1},choosingPackType:{default:null,visible:!1}},setData:function(e){this.data=e,this.reload()},reload:function(){var e=this.node;e.getChildByName("pageName").getComponent("cc.Label").string=this.data.parid+"号包裹",e.getChildByName("packageContentLabel1").getComponent("cc.Label").string=this.data.ticket_prices/G_Con.bigNum,e.getChildByName("packageContentLabel2").getComponent("cc.Label").string=this.data.cost_min/G_Con.bigNum+"-"+this.data.cost_max/G_Con.bigNum,this.setPackType(this.data.parstatus)},refeshTime:function(){var e=this.data.recycle_time,t=new Date,a=e-parseInt(t.getTime()/1e3),n=this.node.getChildByName("packageContentLabel3").getComponent("cc.Label");if(a<0){n.string="已过期";var i=cc.find("confirmBtn/buttonLabel",this.node).getComponent(cc.Label);G_Func.isPackageIsMine(this.data.parid)?i.string="下架":i.string="确定",this.isOutOfTime=!0}else n.string=24<a/3600?"剩余："+parseInt(a/86400)+"天":"剩余："+G_Func.formatSeconds(a)},ctor:function(){},onClickClose:function(){this.node.destroy()},onClickConfirm:function(){this.choosingPackType==G_Con.packageState.enable?(this.isOutOfTime?G_Func.isPackageIsMine(this.data.parid)&&G_Net.autoCall(G_Neb.soldOut,[parseInt(this.data.parid)],0,this.soldOutEnd.bind(this)):G_Net.autoCall(G_Neb.lickParcel,[parseInt(this.data.parid)],this.data.ticket_prices/G_Con.bigNum,this.lickEnd.bind(this)),this.node.destroy()):this.choosingPackType==G_Con.packageState.eaten?this.node.destroy():this.choosingPackType==G_Con.packageState.outDate&&this.node.destroy()},soldOutEnd:function(e){G_Func.checkCallBack(e)},lickEnd:function(e){cc.log("lickEnd : "+e),G_Func.checkCallBack(e)},setPackType:function(e){this.choosingPackType=e;var t=cc.find("confirmBtn/buttonLabel",this.node).getComponent(cc.Label);if(this.choosingPackType==G_Con.packageState.enable)this.schedule(function(e){this.refeshTime()}.bind(this),1),t.string="立即舔包",this.refeshTime();else if(this.choosingPackType==G_Con.packageState.eaten){this.node.getChildByName("packageContentLabel3").getComponent("cc.Label").string="实际获得："+this.data.final_prices/G_Con.bigNum;var a=this.node.getChildByName("packageContentLabelTime"),n=new Date(1e3*this.data.lick_time);a.getComponent("cc.Label").string="开启时间："+n.toLocaleString(),a.active=!0,t.string="确定"}else if(this.choosingPackType==G_Con.packageState.outDate){this.node.getChildByName("packageContentLabel3").getComponent("cc.Label").string="已下架",t.string="确定"}}}),cc._RF.pop()},{}]},{},["Const","GlobalData","GlobalFuc","NetCenter","MainScene","PackageScene","PopPackage"]);